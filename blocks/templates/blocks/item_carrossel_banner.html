{% load wagtailimages_tags %}

<a href="{{ value.link|default:'#' }}" 
   {% if value.link %}target="_blank" rel="noopener noreferrer"{% endif %}
   class="banner-link">

    <picture>
        {# 1. Fonte para MOBILE (se existir) #}
        {% if value.imagem_mobile %}
            {% image value.imagem_mobile original as mobile_img %}
            <source media="(max-width: 768px)" srcset="{{ mobile_img.url }}">
        {% endif %}

        {# 2. Fonte para DESKTOP #}
        {% image value.imagem original as desktop_img %}
        <source media="(min-width: 769px)" srcset="{{ desktop_img.url }}">

        {# 3. Imagem de FALLBACK (obrigatória) #}
        {# Esta é a tag que será realmente renderizada. #}
        <img src="{{ desktop_img.url }}" 
             alt="{{ value.texto_alternativo|default:'imagem' }}" 
             class="banner-image">
    </picture>
  
    {% if value.legenda %}
      <div class="banner-caption">
        {{ value.legenda }}
      </div>
    {% endif %}
</a>